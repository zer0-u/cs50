# 4 Memory

## 1225
- 記憶を失ったのでweek 3のNoteも見直した
    - https://cs50.jp/x/2021/week3/notes/
    - n log nとlog nの違いが分からないんだよな　定数倍ではないらしい
    - なんとなく思い出してきた
- google spreadsheetへのアクセス
    - cs50.ly/art
    - コピーしたもの　https://docs.google.com/spreadsheets/d/13dkNL613yYbEf8WoRXbdp7QEBYv6iwkLH2DfqyFoGIo/edit#gid=0
    - いわゆる「excel方眼紙」で何か描かれている訳ではなかった
- 英語字幕を出す方法がわからなくなった
    - 「自動翻訳」で日本語から英語に移すしかなくなっている？
- 16進数の話
    - なんで16進数を使うようになったんだっけ？
    - 1バイト＝8ビットで表せる数だからだった
    - なんで1バイトは8ビットになったんだろう
- 10進数と16進数を見分ける
    - 頭に0xとついていたら16進数
- 実行するごとに変数nのアドレスが変わる

## 0108

### mallocとfree
- 変数tに変数sの内容を代入してもsに代入されていたポインタが代入されるだけ＝代入した先の変更は変数sとtの両方に影響することは理解したが、t[0]=s[0]はポインタではなく要素の代入になるのはどうしてなんだろう？

### garbage.c
- 1:47:22頃
    - 初期化していない変数を参照するとどんな値が代入されるか分からない
    - 講義動画ではよくわからない数値(intの最大値に見える)が2つと0が1つ
    - 手元で実行した時は3つとも0だった
    - C言語ではデフォルトで何か代入されることはないからちゃんと初期値を代入しようね、という話だと理解

### mallocとfreeの続き
- Javaでいう基本データ型と参照型のように、変数に代入されているものが違うのだろうか？

### swap
- 変数名に*をつけると、変数に代入された値ではなくポインタが代入される
- *と&の使い方がごちゃごちゃになりそう

### scanf
- なんで""で文字列を表すことは決めていたのにstring型はないんだろう
    - 最小限の実装で済ませたかったから？
- char *sと宣言しただけでは「本来ならここにポインタ」があるだけなので、ポインタが指し示す先をmalloc等で用意する必要がある

### phonebook
- 実際のlabやproblem setにはない
    - 例示のためのプログラム？
- 講義動画おわり・今日はここまで

## 0110

### lab:volume
- そこまで難しいことはなさそう
- ファイル操作関係の関数は既に定義されている
- リファレンスサイトが見つからずちょっと探した
    - https://manual.cs50.io/
- fread関数の例を見てなんとなく理解した引数
    - 引数1：読み込むために必要な変数のアドレス
    - 引数2：カーソルそのものの大きさ
    - 引数3：カーソルが一度に動く量
    - 引数4：読み込むファイル
- fwriteも引数は同じらしい
- とりあえずヘッダのコピーだけ試してみる
    - segmentation faultだった
- 指示書きを下まで読んだらfread/fwriteの解説が載っていた
    - まずは最後まで読むべきだった

## 0111

### volume(header)
- 3つ目の引数の役目がわからない
- とりあえずfread関数の例にある通りwhile文を書いてみる
    - すごい量の数字が出てきた
- 頭から44番目までを切り取れば良いのか？
- wavファイルではなく中身がintのテキストファイルで試してみよう
- ウォークスルーの動画が役に立った試しがない
    - 説明書きのほうが詳しい
    - オリジナルは動画しかないんだろうか
- テキストファイルでいろいろ試してみた
    - 2つ目の引数はカーソルの大きさ
    - 3つ目の引数はファイルに書き込まれた内容を区切る単位？
    - 両方sizeof(char)にしたら大丈夫だった
- volumeに戻る
    - uint8_tを1個分読み込むことに成功した
- これをHEADER_SIZE分繰り返せばいいのか？
- またテキストファイルで試してみる
    - 配列を作る意味がわかっていない
    - 読み込んだ端から書き出していけばいいのでは？
    - 同じfor文の中でfreadとfwriteを呼び出しても大丈夫そう
    - for文のインデックスでコピーする分量を制限できる
- volumeに引っ越す
- ヘッダーのコピーはできた気がする

### volume(body)
- ファイルの途中からコピーする必要がある
- 再びテキストファイルに戻る
- ヘッダのコピーで使ったfor文は、インデックスのiがループ終了条件の役割しか果たしていない
    - while文でも置き換えられる
    - 処理中にインデックスiが参照されない
- 途中から見るにはどうしたらいいんだろう？
-　ヘッダと本体でループを分けるのではなく、1つのループ処理の中で「ヘッダかそうでないか」を判断すべき？
    - テキストファイルバージョンで試したら行けそうな気がした
    - 書き込む前に処理を挟むことにも成功した
- forではなくwhileを使おうとするとインデックスとカーソルの2変数がスコープ外になるのでちょっと悲しい
- ヘッダはuint8_t, 本体はint16_tを使うから読み込み方法が違うことに気付いた
    - どうしよう
    - やっぱりループを分けて、本体コピー中は「ヘッダであれば何もしない」を挟む？
- uint8_tは1バイト(符号なし)、int16_tは2バイト(符号あり)、ヘッダは44バイト
- 「ヘッダであれば何もしない」を入れてみる
- それにしてもどうして説明には配列があるんだろう
- とりあえずそのままコピーはできたっぽい
- 後は音量を調整する
    - これはそこまで難しくなかった
    - 2倍程度だとあんまり差がわからないので10倍にしたら音が割れた
- あちこちでsizeofを呼び出しているので変数にまとめる
- 一応できたけどこれでいいかはちょっとわからない
    - 配列の謎はそのまま
- solution(動画)を見てみる
    - カーソルに配列を使うと、配列の要素の数だけ一括で読み込めるらしい
    - 模範解答は本体の読み込み時に「ヘッダー分を除く」的な処理を書いていない
    - ファイルを閉じるまでカーソルの位置は保持される……？

