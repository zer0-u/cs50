# week6 python

## 0213

### 講義動画
- ここからpythonを学ぶ
  - 多少は知っている言語なので気が楽かもしれない
- printはデフォルトで改行を行う
- フォーマット文字列の書き方は比較的新しい書き方
  - f'hello, {answer}'
  - python 3.6から
- pythonは型を指定しない
- セミコロンもいらない
- pythonにはインクリメント(++)やデクリメント(--)がない
- ブール値の先頭は大文字(True / False)
- for文にはrange関数を渡すことが多い
  - 引数を使って細かくカスタマイズできる
- pythonの型
  - bool, float, int ,str(string)
  - range, list, tuple, dict, set,...
- import文の使い方
  - 関数を限定したimportも可能

## 0219

### 講義動画(22:10)
- pythonにインクリメント演算子がない理由
  - 歴史上の事情？
  - シンプルさを重要視する傾向にあるかもしれない
- pythonのコードの書き方と実行方法
  - python ファイル名
- pythonには明示的なコンパイルが存在しない(インタプリタ)
- blur.pyを写経している
  - ちゃんと動くのかな？
  - stadium.bmpは4週目のpsetからコピーしてきた
- オブジェクト指向は値の他に機能も同じカプセルを収める
- フォルダ構造をなるべく動画と揃える(filterフォルダ)
- 動いた気がする
  - BoxBlurの引数を大きい数にしたら差がはっきり分かった
- PILはPillowの略？(31:59)

## 0220

### 講義動画(33:13)
- spellerをpythonに置き換える
- speller.cに相当するファイルは配布されたらしい
  - どこにあるんだろう(後で調べる)
- rstrip関数は文字列から改行文字を取り除いてくれる
- dictのキーに相当するものはどうやって決めるんだろう
- mallocとfreeは使わない(pythonが自動的に管理している)ので、unload関数では何も行わない
- dictは例として出しただけで、実際はsetを使うっぽい？(36:52)
- 配布コードは2023版からzipを落としてきた
  - https://cs50.harvard.edu/x/2023/weeks/6/
- C言語版より時間がかかる(3秒vs11秒)
  - 書きやすさと速度のトレードオフ
- pythonを高速化する方法もあるはず
  - 中間結果を保存する機能がある
- 新しい言語を使うことのポイントは、他の人が実現してくれた抽象化を活用するところにある
- pythonはコンパイルできるか
  - 内部でコンパイルは行われている
  - コンパイルは開発者の関心事から外れている

### 講義動画(45:18)
- これまでCで書いたものをPythonに置き換える
- なぜか突然別のターミナルで対話型のコマンドが動き始めたので閉じた
- python hello1.pyをしてからWhat's your nameが出るまでちょっと間がある
  - 入力が割り込んでも結果は正しく出る
- pythonにはmain関数がない
- get_stringという補助輪を取り除く(hello2.py)
  - get_stringをinputに置き換える
  - 現時点では全く同じ働き
- 新しいファイルを作るとなぜか対話型コマンドが動いてしまう
- import cs50 に置き換える(すべての関数をインポートする)とうまくいかない
- トレースバック＝スタックトレース
- pythonは名前空間と呼ばれるようなものをサポートしている
  - Javaでいうパッケージのようなもの？
- import cs50だけにする場合、get_intの前にcs50.と付けて名前空間を明示しなければならない
- 明示してインポートするか、全部インポートして名前空間を示すかはインポートしたい関数の数による
- get_intを取り除く(calculator0_1.py)
  - get_intもinputに置き換える
  - 文字列として認識されてしまう(1+2が3ではなく12になる)
  - int型へのキャストを行う(intは関数のようなもの)
- 意地悪に文字列を入力すると例外が発生する(トレースバックが表示される)
- 例外に対処する
  - tryとexcept
  - cs50ライブラリのget_intでは内部でtry/exceptを行っている
- exceptの後ろにエラーの名前を指定できる
  - except ValueError: で値の変換に失敗した時のみ実行される
  - 今は深入りしない(cs50ライブラリに頼る)
- 夜が更けてきたので今日はここまで(59:00頃)

## 0221

### 講義動画(59:00)
- 割り算を行うプログラム(calculator1.py)
- 割り切れない数を指定すると結果の型は浮動小数点型と推測される
  - 余り部分を切り捨てない
  - 切り捨てたい場合は/ではなく//を使う
- 有効桁数を増やす
  - f"{z:.50f}" ←50桁
- 浮動小数点数の不正確性はそのまま残っている
- pythonのコメントは//ではなく#
- points.pyを作る
  - points.cの焼き直しらしいがもともとのファイルがわからない
  - 整数を入力してifで分岐しているっぽい
- parity.pyを作る
- 剰余演算子%は同じ
- なんか見たことないソースコードがたくさん出てくる
  - 覚えていないだけ？
  - 難しい内容ではない(入力値に応じた分岐)
- pythonにcharはない
  - stringに含まれている
  - ダブルクオートとシングルクオートは同じ意味を持つ
- 「または」は || ではなく or
- 選択肢を増やしたい
  - Y, y, yes, YESなどをすべて同じように扱いたい
- リストを使う
  - s in [候補リスト]
- s.lower()として大文字・小文字の差を無視すると候補リストが短くなる
- s.lower()の別の変数として独立させる
  - 再代入すればよい
  - またはget_stringの戻り値に直接.lower()をつける
- pythonにおける文字列は文字の配列ではないのか？
  - 文字列はオブジェクトになっている
  - 文字列はイミュータブル
  - 変更を加えたものは新たな文字列として生成される

### 講義動画(1:13:14)
- 繰り返し処理を実装する
  - meow.py
- meowを関数に分離する(meow1.py)
- 宣言より先に呼び出そうとするとNameErrorが発生する
  - 順序を入れ替えれば簡単に解決できるが賢いとは言えない
- main関数を導入するとNameErrorは解決するが何も表示されなくなる
  - 宣言だけして呼び出さなかったから
- pythonにおけるmain関数は単なる慣習
  - 最後に呼び出す必要がある
  - インタプリタがすべての関数を読み込んだ後に実行される
- if __name__ == "__main__" といったものはライブラリの問題を解決するためにある
  - 今は特に必要ないので書かない
- meow関数に引数を持たせる
- pythonにおける変数のスコープ
  - 定数がない
  - 基本的には関数スコープ
  - どの関数にも属さない位置に宣言すればグローバル変数とみなされる
    - いくつか注意事項がある(後述)
- イミュータブルなのでメモリは多く使うが、そのあたりはpythonが管理してくれるので気にしなくて良い
- mario.pyを作る
- すごく速いんだけど手を動かしながら見るものでもないんだろうか
- ブロックの数を入力してもらう
  - 文字列など、整数以外の値が入力された場合の処理はget_int内で行ってくれる
  - 負の数が入力された時も再入力を求めるようにしたい
- pythonにはdo-whileがない
  - whileはある
  - while Trueとbreakで擬似的にdo-whileを実装する
- cs50ライブラリの補助輪を外す(mario1.py)
- 変数のスコープが微妙な気がする
  - whileループの外側から参照しているように見える
  - 関数スコープなのでネストの外側からでも参照できる
- 例外を使ってget_intをなくす
  - int関数で変換するのを忘れない
  - whileループの中にtry-exceptを含むので、想定外の入力に対して再入力を求められる
- 今日はここまで(1:31:00頃)

## 0223

### 講義動画(1:31:00)
- mario.pyを改善する
  - ブロックを横に並べる
- 新たに1から書き直すらしい(mario2.py)
- print関数は出力内容の他に引数を取る
  - 改行するかどうかも引数で指定できる
  - 名前付き変数を使う
  - 引数endに空文字列を指定すると終了後に改行されなくなる
  - 最後にも改行されないので、ループが終わった後に単純なprintを置いておく
- print("?" * 4)でも?が4つ出力される
- 2次元的なブロックを表現する(3×3の正方形)
- end=""のようにイコールの前後にスペースを入れないのが慣習
  - スペースをへらすときもある

### 講義動画(1:38:23)
- pythonのドキュメント
  - https://docs.python.org/3/
- week2のscores.cをpython化する(scores.py)
  - 配列の違いを知る
- 配列にはsum関数とlen関数を適用できる
- ユーザーからの入力を受け付ける
- pythonのリストは長さの制限がない
- 要素を追加する時はappendメソッドを呼び出す
  - scores += [score] でも同じことができる
  - リストscoresに要素を1つ(score)持つリストを結合する、という意味
- uppercase.cも移植する
- 文字列もforループで1文字ずつ取り出せる
- before.upper()で一括して大文字化できる
- pythonには文字型がないので、1文字ずつ取り出したとしても「文字列の処理」は変わらない
  - 一括でやったほうが分かりやすい
- pythonのコマンドライン引数(argv.py)
- 何らかのショートカットが暴発して字幕が薄くなる事件が発生した
  - 歯車＞字幕＞オプション＞リセットで直せる
- コマンドライン引数を参照したい時はsysライブラリからargvをインポートする
  - argvはリスト(配列)
  - pythonのコマンドライン引数は「python」(実行時コマンド)を含まない
- ファイル名(argv.py)も対象から外したいのでリストをスライスする
  - argv[1:] ←1個目の要素から(0番目を無視する)
  - argv[:-1] ←最後の要素を無視する
- exit.pyを実装する(1:54:23)
  - sysライブラリにあるexit関数を呼び出すと終了時のコードを指定できる？
  - importしなくてもexitそのものは呼び出せる
  - ※要調査
- import sysでsysライブラリにあるすべての関数をインポートした場合は、呼び出す時にsys.が必要
- 二分探索 numbers.py(1:56:37)
  - pythonは if 要素 in 配列 で検索が行われる
  - 内部的には二分探索
  - 自分でアルゴリズムを実装する必要はない
- 数値以外も検索できる(names.py)
  - 文字列の場合はデフォルトで線形検索を行うらしい
- phonebook.py(1:58:54)
  - オブジェクトやクラスを用いる
- 辞書を使う
  - dict() または {} で空のdictionaryオブジェクトを生成する
- 辞書の場合も if 要素 in 辞書 で検索できる
  - 紐付けられた値を参照する時は people[キー]
- なぜかわからないがphonebook.pyが上手く動かない
  - 別のプログラムだと混同されている
  - 直らない
  - from cs50 import get_stringがあるとなぜかfoundになってしまう
  - 他のプログラムでも起きる
  - 困ったな
  - と思ったら動画でも同じ現象が起きている
  - 別のフォルダに移すとちゃんと動く
  - 原因不明
  - ひとまずtempフォルダで続きを行う
- CSVファイルを読み込むようにする(phonebook1.py)
- open関数の第二引数"a"は「追加(append)」を意味する
  - 通常の書き込みだと上書きされる
- writerowメソッドの引数はリスト(角括弧を使っていることに注目)
- withを使うとcloseが自動化される？
  - try-with-resourcesと同じようなものだろう
- https://cs50.ly/hogwarts
  - アクセスするよう言われるが404
  - アーカイブ視聴の場合は404になってしまうらしい(見るだけ)
  - 投稿日時とホグワーツ寮のペア値が300ちょっと並んでいる
- 実行はできないが一応hogwarts.pyを作っておく
  - 寮の名前も省略

### 講義動画(2:16:15)
- 発展的な機能の紹介
- Python text to speech(pyttsx3)
  - 読み上げソフト
- face_recognition(顔認証)
  - 画像から顔だけを検出するライブラリ
- 音声認識
- QRコード生成
- 動画おわり！

## 0225
- 演習やろうとしたらcodespaceのURLが無効になっててびっくりした
  - なんかたまに移動するというかアクセスできない時がある
  - 中身が消えるのは困るけどどうしたらいいんだろう
  - codespaceがアクセスできなくなるだけならいいんだが……
- ついでにフォントを変えようかなと思ったがupdateのたびに入れ直しになると気付いて断念

### lab(準備)
- lab6フォルダはlabに改名した
- ダブルクオート3つで囲った文字列は改行を含められる
  - 今回の例では複数行コメントとして使っている
- ゲームの勝敗を決める部分は実装済(simulate_game関数)
- 簡単そうに見えるがそうでもなさそうな……

### lab ファイル読み込み
- まずはチーム名とレートの読み込み
  - これはhogwarts.pyを参照すればいけると思う
  - 合ってるか不安になる
  - 読み込み部分だけ別のプログラムに切り出してみる(input.py)
- やっぱり上手く行ってなかった
- チーム名とレーティングのペアを1つの要素としてリストに詰めたい
- 入れ方はなんとなくわかったがリストの扱い方が分からない
- どうやらdictではなくsetとして追加してしまったらしい
  - 省略記法がいまだピンとこない
- dictは{キー:値}
  - キーや値の部分に変数名を書いてもOK
- とりあえず求めるものは実装できたのでtournament.pyにコピーする
- ratingをintに変換しそびれていた
- 問題文を読むに、もしかしたら要素の形は{team: チーム名, rating: レート}なのかもしれない
- 直しておこう
- コピペするとインデントがずれるのが気になる

### lab simulate_tournament関数
- simulate_roundを1回実行すると、同じ階層の対決が行われる
- 勝ち上がったチームのみを含む配列が返されるから、1回の呼び出しで要素が半分になる
- 要素が1個なら優勝が決まったことになる
- 1個になるまでsimulate_roundを呼び出す
- テストしづらいな……
- 戻り値の説明を見落としていた
  - 「この関数は、そのチームの名前を返します。」
  - ratingはいらないらしい
- 恐らく大丈夫だと思う
  - 試合の予想がランダムだから確信が持てない

### lab トーナメントシミュレーション
- simulate_tournament関数をN回呼び出せばいいはず
- できたのではないかと思われる
- countsの初期化をファイル読み込み時に行ったけどこれでも大丈夫だろうか
  - 0.0%の国も出てくる
  - Japanがいつまで経っても0%でちょっとしょんぼり

### lab check50
:) tournament.py exists
:) tournament.py imports
:) simulate_tournament handles a bracket of size 2
:) simulate_tournament handles a bracket of size 4
:) simulate_tournament handles a bracket of size 8
:) simulate_tournament handles a bracket of size 16
:) correctly keeps track of wins
:) correctly reports team information for Men's World Cup
:) correctly reports team information for Women's World Cup
できた！

### 解説動画
- なにもないところから team["team"]=値 としても新たなdictオブジェクトは生成できる
  - 分かりづらいからあまり使いたくない
- と思ったけど、恐らくreaderから得られる要素1つ1つがdictになっているっぽい
- ratingのint化だけで問題なかったのかもしれない

## 0301

### pset hello
- そこまで難しくないはず
- get_stringのプロンプトを改行する方法が分からなかった
  - printで代用

### pset mario(less)
- 入力してもらった値(height)を使って上手いこと範囲を指定できない
- 求める出力は得られたが冗長なので改善したい
- range関数の第一引数が開始・第ニ引数が終了
  - 第ニ引数の値は含まれない
- ifの条件でもrangeが使える
  - if 値 in range(最小, 最大+1)
- 問題文を読み違えていた(最小値は0ではなく1)

## 0302

### pset mario(more)
- range関数で終了値を含む方法はないらしい
- こちらもとても簡単
- 真ん中の隙間をprintする時にendの指定を忘れたくらい
- ケアレスミスに注意

### pset cash
- セントとドルの関係が分からん
  - 100セント＝1ドル？
  - 1週目のメモを見ると↑で合ってる
- 入力値はドルなので100倍する必要がある
- ちょっと欲を出して関数に切り分けたら失敗した
- dictの使い方がまだ覚えられていない
  - 戻り値の返し方の問題だった
- なんか結果が違う
- calc関数のループ条件に問題があった
  - >ではなく>=
- 2つの値を返さなきゃいけないってなるとあんまり効率よくないな
- コインの種類をlistにしたらさらに短くなる？
- だいぶ短くなった！
- check50も通った
- dictのプロパティ名に変数が使えるってすごいけど面倒な気がする

## 0303

### pset credit
- アルゴリズムが難しいやつだ
- 正規表現の使い方も学ばなければならない
- re(正規表現)の日本語URL
  - https://docs.python.org/ja/3/library/re.html
- よく考えると文字数で分けるだけなら正規表現いらない気がする
  - 先頭文字の判別くらいはしてもいいかもだが今回は正規表現を学ぶのが目的ではないし……
  - 試すだけ試してみよう
- 読んだ記事
  - https://qiita.com/luohao0404/items/7135b2b96f9b0b196bf3
- 一応できた(re_credit.py)
- 余裕があればもっと調整したものを作るかもしれない
  - TODO.mdにメモした
- 文字列[start:stop]とするとstartからstopまでの範囲を切り出せる
  - range同様stopは含まれない
  - startを省略した場合は0が代入される
  - 先頭2文字がほしいときは[0:2]または[:2]
- 先頭文字列を判断するのに正規表現を使えるかもしれない？